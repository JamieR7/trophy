<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SEHS Paper 1B Practice</title>
    <style>
        :root {
            --color-primary: #004587;
            --color-primary-hover: #003570;
            --color-primary-active: #002a5a;
            --color-success: #fbba07;
            --color-error: #e73037;
            --color-warning: #F59E0B;
            --color-bg: #F8FAFB;
            --color-surface: #FFFFFF;
            --color-text: #1F2937;
            --color-text-secondary: #6B7280;
            --color-border: #E5E7EB;
            --radius-base: 8px;
            --radius-lg: 12px;
            --spacing-8: 8px;
            --spacing-12: 12px;
            --spacing-16: 16px;
            --spacing-24: 24px;
            --spacing-32: 32px;
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            padding: var(--spacing-16);
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .container {
            width: 100%;
            max-width: 700px;
            background: var(--color-surface);
            border-radius: var(--radius-lg);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            padding: var(--spacing-32);
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--spacing-24);
            border-bottom: 2px solid var(--color-border);
            padding-bottom: var(--spacing-16);
        }

        .header h1 {
            margin: 0;
            font-size: 24px;
            color: var(--color-text);
        }

        .stats {
            display: flex;
            gap: var(--spacing-16);
            font-size: 14px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-label {
            color: var(--color-text-secondary);
            font-size: 12px;
            margin-bottom: var(--spacing-8);
        }

        .stat-value {
            font-size: 18px;
            font-weight: bold;
            color: var(--color-primary);
        }

        .stat-value.streak {
            color: var(--color-success);
        }

        .question-container {
            margin-bottom: var(--spacing-24);
        }

        .question-number {
            color: var(--color-text-secondary);
            font-size: 14px;
            margin-bottom: var(--spacing-8);
        }

        .question-text {
            font-size: 18px;
            font-weight: 600;
            color: var(--color-text);
            margin-bottom: var(--spacing-16);
            line-height: 1.5;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-12);
        }

        .option {
            padding: var(--spacing-12) var(--spacing-16);
            border: 2px solid var(--color-border);
            border-radius: var(--radius-base);
            background: var(--color-surface);
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 16px;
            text-align: left;
            color: var(--color-text);
        }

        .option:hover {
            border-color: var(--color-primary);
            background: #F0FFFE;
        }

        .option.selected {
            border-color: var(--color-primary);
            background: #E0FFFE;
            font-weight: 600;
        }

        .option.correct {
            border-color: var(--color-success);
            background: #DCFCE7;
            color: #166534;
        }

        .option.incorrect {
            border-color: var(--color-error);
            background: #FEE2E2;
            color: #991B1B;
        }

        .feedback {
            margin-top: var(--spacing-16);
            padding: var(--spacing-12) var(--spacing-16);
            border-radius: var(--radius-base);
            font-size: 14px;
            line-height: 1.5;
            display: none;
        }

        .feedback.show {
            display: block;
        }

        .feedback.correct {
            background: #DCFCE7;
            color: #166534;
            border-left: 4px solid var(--color-success);
        }

        .feedback.incorrect {
            background: #FEE2E2;
            color: #991B1B;
            border-left: 4px solid var(--color-error);
        }

        .button-group {
            display: flex;
            gap: var(--spacing-12);
            margin-top: var(--spacing-24);
        }

        .btn {
            flex: 1;
            padding: var(--spacing-12) var(--spacing-16);
            border: none;
            border-radius: var(--radius-base);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .btn-primary {
            background: var(--color-primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--color-primary-hover);
        }

        .btn-primary:disabled {
            background: #D1D5DB;
            cursor: not-allowed;
        }

        .btn-secondary {
            background: var(--color-border);
            color: var(--color-text);
        }

        .btn-secondary:hover {
            background: #D1D5DB;
        }

        .streak-milestone {
            background: linear-gradient(135deg, #fbba07 0%, #e73037 100%);
            border: 2px solid #004587;
            padding: var(--spacing-24);
            border-radius: var(--radius-lg);
            text-align: center;
            margin-bottom: var(--spacing-24);
        }

        .milestone-icon {
            font-size: 48px;
            margin-bottom: var(--spacing-12);
        }

        .milestone-text {
            font-size: 20px;
            font-weight: bold;
            color: #78350F;
            margin-bottom: var(--spacing-8);
        }

        .download-section {
            background: #EFF6FF;
            border: 2px solid #0EA5E9;
            padding: var(--spacing-16);
            border-radius: var(--radius-base);
            margin-top: var(--spacing-16);
        }

        .progress-bar {
            width: 100%;
            margin: var(--spacing-24) 0;
            padding: var(--spacing-16);
            background: #F3F4F6;
            border-radius: var(--radius-lg);
        }

        .progress-track {
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            gap: var(--spacing-12);
            margin-bottom: var(--spacing-12);
        }

        .trophy-card {
            aspect-ratio: 1;
            border-radius: var(--radius-base);
            border: 2px solid #E5E7EB;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            position: relative;
            overflow: hidden;
            padding: 12px 8px;
            min-height: 85px;
        }

        .trophy-card:hover:not(.locked) {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .trophy-card.unlocked {
            background: linear-gradient(135deg, #fbba07 0%, #e73037 100%);
            border-color: #004587;
            box-shadow: 0 4px 12px rgba(0, 69, 135, 0.3);
        }

        .trophy-card.current {
            border: 3px solid #004587;
            box-shadow: 0 0 12px rgba(0, 69, 135, 0.6);
        }

        .trophy-card.locked {
            background: #E5E7EB;
            cursor: not-allowed;
            opacity: 0.5;
        }

        .trophy-emoji {
            font-size: 32px;
            line-height: 1;
            margin-bottom: 6px;
        }

        .trophy-label {
            font-size: 13px;
            font-weight: 700;
            color: #1F2937;
            text-align: center;
            background: rgba(255, 255, 255, 0.9);
            padding: 3px 8px;
            border-radius: 4px;
            line-height: 1;
        }

        .trophy-card.unlocked .trophy-label {
            background: rgba(255, 255, 255, 0.95);
            color: #004587;
        }

        .milestone-info {
            font-size: 12px;
            color: #6B7280;
            text-align: center;
        }

        .download-section h3 {
            margin: 0 0 var(--spacing-12) 0;
            color: #0369A1;
            font-size: 16px;
        }

        .download-buttons {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-8);
        }

        .btn-download {
            padding: var(--spacing-10) var(--spacing-16);
            background: #fbba07;
            color: #004587;
            border: 2px solid #004587;
            border-radius: var(--radius-base);
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.2s ease;
            text-decoration: none;
            text-align: center;
            display: inline-block;
        }

        .btn-download:hover {
            background: #e73037;
            color: white;
        }

        .finish-screen {
            text-align: center;
        }

        .finish-screen h2 {
            font-size: 24px;
            color: var(--color-text);
            margin-bottom: var(--spacing-12);
        }

        .score-display {
            font-size: 36px;
            font-weight: bold;
            color: var(--color-primary);
            margin-bottom: var(--spacing-24);
        }

        @media (max-width: 600px) {
            .container {
                padding: var(--spacing-16);
            }

            .header {
                flex-direction: column;
                gap: var(--spacing-16);
            }

            .header h1 {
                font-size: 20px;
            }

            .button-group {
                flex-direction: column-reverse;
            }

            .stats {
                justify-content: center;
            }

            .progress-track {
                grid-template-columns: repeat(6, 1fr);
                gap: var(--spacing-8);
            }

            .trophy-card {
                min-height: 70px;
                padding: 8px 4px;
            }

            .trophy-emoji {
                font-size: 24px;
            }

            .trophy-label {
                font-size: 11px;
                padding: 2px 6px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>SEHS Paper 1B Practice</h1>
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-label">Correct</div>
                    <div class="stat-value" id="correct-count">0</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Streak</div>
                    <div class="stat-value streak" id="streak-count">0</div>
                </div>
                <div class="stat-item">
                    <div class="stat-label">Total</div>
                    <div class="stat-value" id="total-count">0</div>
                </div>
            </div>
        </div>

        <div id="quiz-content">
            <div class="question-container">
                <div class="question-number">Loading...</div>
                <div class="question-text">Initializing quiz...</div>
            </div>
        </div>
    </div>

    <!-- Load questions from external file -->
    <script src="questions.js"></script>

    <script>
        const GITHUB_USERNAME = 'JamieR7';
        const GITHUB_REPO = 'trophy';

        let currentQuestionIndex = 0;
        let shuffledQuestions = [];
        let correct = 0;
        let total = 0;
        let streak = 0;
        let answered = false;
        let selectedAnswer = -1;
        const trophySequence = [
            { streak: 1, name: 'FIFA World Cup', file: 'Trophys/FIFA.png', emoji: '‚öΩ' },
            { streak: 3, name: 'Calcutta Cup', file: 'Trophys/Calcutta_Cup.png', emoji: 'üèâ' },
            { streak: 5, name: 'FIVB World', file: 'Trophys/FIVB.png', emoji: 'üèê' },
            { streak: 7, name: 'The Ashes', file: 'Trophys/The_Ashes.png', emoji: 'üèè' },
            { streak: 10, name: 'Snooker', file: 'Trophys/Snooker.png', emoji: 'üé±' },
            { streak: 13, name: 'Americas Cup', file: 'Trophys/Americas_cup.png', emoji: '‚õµ' },
            { streak: 17, name: 'Larry O\'Brien', file: 'Trophys/Larry_OBrien.png', emoji: 'üèÄ' },
            { streak: 21, name: 'Davis Cup', file: 'Trophys/Davis_Cup.png', emoji: 'üéæ' },
            { streak: 25, name: 'Ryder Cup', file: 'Trophys/Ryder_Cup.png', emoji: '‚õ≥' },
            { streak: 30, name: 'Venus Rosewater', file: 'Trophys/Venus_Rosewater.png', emoji: 'üéæ' },
            { streak: 35, name: 'Olympic Gold', file: 'Trophys/Olympic_gold.png', emoji: 'ü•á' },
            { streak: 40, name: 'Yellow Jersey', file: 'Trophys/Yellow_jersey.png', emoji: 'üö¥' }
        ];

        function shuffleArray(array) {
            const arr = [...array];
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }

        function initializeQuiz() {
            // TRUE RANDOMIZATION: Shuffle questions every time quiz starts/restarts
            shuffledQuestions = shuffleArray(allQuestions);
            currentQuestionIndex = 0;
            correct = 0;
            total = 0;
            streak = 0;
            updateStats();
            loadQuestion();
        }

        function createProgressBar() {
            let html = '<div class="progress-bar"><div class="progress-track">';

            trophySequence.forEach((trophy) => {
                let cardClass = 'trophy-card locked';

                if (streak >= trophy.streak) {
                    cardClass = 'trophy-card unlocked';
                }

                html += `<div class="${cardClass}" title="${trophy.name}">
                    <div class="trophy-emoji">${trophy.emoji}</div>
                    <div class="trophy-label">${trophy.streak}</div>
                </div>`;
            });

            html += '</div><div class="milestone-info">Progress: ';
            const unlockedCount = trophySequence.filter(t => streak >= t.streak).length;
            html += `${unlockedCount} of ${trophySequence.length} trophies unlocked</div></div>`;

            return html;
        }

        function loadQuestion() {
            if (currentQuestionIndex >= shuffledQuestions.length) {
                showFinishScreen();
                return;
            }

            answered = false;
            selectedAnswer = -1;
            const q = shuffledQuestions[currentQuestionIndex];

            let html = createProgressBar();

            html += `
                <div class="question-container">
                    <div class="question-number">Question ${currentQuestionIndex + 1}</div>
                    <div class="question-text">${q.q}</div>
                    <div class="options">
            `;

            q.options.forEach((opt, idx) => {
                html += `<div class="option" onclick="selectAnswer(${idx})">${String.fromCharCode(65 + idx)}. ${opt}</div>`;
            });

            html += `
                    </div>
                    <div class="feedback"></div>
                    <div class="button-group">
                        <button class="btn btn-primary" onclick="submitAnswer()">Submit</button>
                        <button class="btn btn-secondary" onclick="nextQuestion()" style="display: none;" id="next-btn">Next Question</button>
                    </div>
                </div>
            `;

            document.getElementById('quiz-content').innerHTML = html;
        }

        function selectAnswer(idx) {
            if (answered) return;
            selectedAnswer = idx;
            const options = document.querySelectorAll('.option');
            options.forEach((opt, i) => {
                opt.classList.toggle('selected', i === idx);
            });
        }

        function submitAnswer() {
            if (answered || selectedAnswer === -1) return;

            answered = true;
            total++;
            const q = shuffledQuestions[currentQuestionIndex];
            const isCorrect = selectedAnswer === q.correct;

            if (isCorrect) {
                correct++;
                streak++;
                checkMilestone();
            } else {
                streak = 0;
            }

            updateStats();

            const options = document.querySelectorAll('.option');
            options.forEach((opt, i) => {
                opt.style.pointerEvents = 'none';
                if (i === q.correct) {
                    opt.classList.add('correct');
                } else if (i === selectedAnswer) {
                    opt.classList.add('incorrect');
                }
            });

            const feedback = document.querySelector('.feedback');
            feedback.classList.add('show', isCorrect ? 'correct' : 'incorrect');

            // Show full correct answer with letter AND text
            if (isCorrect) {
                feedback.innerHTML = '‚úì Correct!';
            } else {
                const correctLetter = String.fromCharCode(65 + q.correct);
                const correctText = q.options[q.correct];
                feedback.innerHTML = `‚úó Incorrect. The correct answer is <strong>${correctLetter}. ${correctText}</strong>`;
            }

            document.querySelector('.btn-primary').style.display = 'none';
            document.getElementById('next-btn').style.display = 'block';
        }

        function nextQuestion() {
            currentQuestionIndex++;
            loadQuestion();
        }

        function updateStats() {
            document.getElementById('correct-count').textContent = correct;
            document.getElementById('streak-count').textContent = streak;
            document.getElementById('total-count').textContent = total;
        }

        function checkMilestone() {
            const milestone = trophySequence.find(t => t.streak === streak);
            if (milestone) {
                setTimeout(() => {
                    const existingMilestone = document.querySelector('.streak-milestone');
                    if (existingMilestone) existingMilestone.remove();

                    const milestoneDiv = document.createElement('div');
                    milestoneDiv.className = 'streak-milestone';
                    milestoneDiv.innerHTML = `
                        <div class="milestone-icon">${milestone.emoji}</div>
                        <div class="milestone-text">üéâ ${streak} Streak Milestone!</div>
                        <p style="margin: 0; color: #78350F;">You've unlocked the ${milestone.name}!</p>
                    `;

                    const container = document.querySelector('.question-container');
                    container.parentNode.insertBefore(milestoneDiv, container);

                    createDownloadButton(milestone);
                }, 500);
            }
        }

        function createDownloadButton(milestone) {
            const downloadDiv = document.createElement('div');
            downloadDiv.className = 'download-section';
            downloadDiv.innerHTML = `
                <h3>üèÜ Download Your Trophy!</h3>
                <div class="download-buttons">
                    <a href="https://raw.githubusercontent.com/${GITHUB_USERNAME}/${GITHUB_REPO}/main/${milestone.file}" 
                       download="${milestone.name}.png" 
                       class="btn-download"
                       target="_blank">
                        üì• Download ${milestone.name}
                    </a>
                </div>
            `;

            const milestoneEl = document.querySelector('.streak-milestone');
            if (milestoneEl) {
                milestoneEl.appendChild(downloadDiv);
            }
        }

        function showFinishScreen() {
            const percentage = total > 0 ? Math.round((correct / total) * 100) : 0;

            let html = createProgressBar();
            html += `
                <div class="finish-screen">
                    <h2>Quiz Complete! üéâ</h2>
                    <div class="score-display">${correct}/${total} (${percentage}%)</div>
                    <p style="color: #6B7280; margin-bottom: 24px;">
                        You've unlocked ${trophySequence.filter(t => streak >= t.streak).length} out of ${trophySequence.length} trophies!
                    </p>
                    <div class="button-group">
                        <button class="btn btn-primary" onclick="initializeQuiz()">Start New Quiz</button>
                    </div>
                </div>
            `;

            document.getElementById('quiz-content').innerHTML = html;
        }

        // Initialize quiz on page load with TRUE RANDOMIZATION
        initializeQuiz();
    </script>
</body>
</html>
